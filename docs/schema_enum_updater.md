# スキーマ列挙型更新スクリプト

OpenAPI仕様のYAMLファイル内のスキーマ定義の列挙型（enum）値を自動的に更新するスクリプトです。

## 機能

1. テーブル形式の説明文から列挙型値を抽出
   - `<table>`、`<thead>`、`<tbody>`、`<tr>`、`<td>`タグを含む説明文を検出
   - テーブルの最初の列から値を抽出
   - 重複する値を自動的に除外

2. 既存の列挙型定義の検出と保護
   - 既存の列挙型定義がある場合は、新しい値を追加しない
   - 既存の定義をそのまま保持

3. 型に応じた適切な形式での出力
   - 文字列型：一重引用符で囲む（例：`'value'`）
   - 数値型：数値として出力（例：`123`）

4. バックアップ機能
   - 処理前に自動的にバックアップファイルを作成（`.bak`拡張子）
   - 元のファイルは`<ファイル名>.bak`として保存

## 使用方法

```bash
dart run bin/update_schema_enums.dart --input <YAMLファイルのパス>
```

### オプション

| オプション | 説明 | 必須 |
|-----------|------|------|
| `--input` | 入力YAMLファイルのパス | はい |
| `--backup` | バックアップファイルの作成 | いいえ |

### 使用例

```bash
# 例：kabu_station_api.yamlの列挙型値を更新
dart run bin/update_schema_enums.dart --input example/open_api_files/kabu_station_api.yaml
```

## 入力形式

テーブル形式の説明文は以下の形式である必要があります：

```yaml
description: |
  <table>
    <thead>
      <tr>
        <th>値</th>
        <th>説明</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>value1</td>
        <td>説明1</td>
      </tr>
      <tr>
        <td>value2</td>
        <td>説明2</td>
      </tr>
    </tbody>
  </table>
```

## ログ出力

スクリプトは処理の各段階でログを出力します：

- スキーマセクションの検出
- プロパティの検出
- 型の検出
- 既存の列挙型定義の検出
- テーブルからの値抽出
- 列挙型値の追加

これらのログにより、処理の進行状況や問題の特定が容易になります。

## 注意事項

1. 入力ファイルは有効なYAML形式である必要があります
2. テーブル形式の説明文は上記の形式に従う必要があります
3. 既存の列挙型定義がある場合、その定義は保持されます
4. 処理前に必ずバックアップが作成されます
5. 列挙型値の重複に注意してください 